@{
    var userRole = ViewContext.HttpContext.Session.GetString("UserRole") ?? "Patient";
    var currentPath = ViewContext.HttpContext.Request.Path.ToString();
    var userName = ViewContext.HttpContext.Session.GetString("UserName") ?? "User";
    var userEmail = ViewContext.HttpContext.Session.GetString("UserEmail") ?? "";
}

<!-- Sidebar wrapper starts -->
<nav id="sidebar" class="sidebar-wrapper">

  <!-- Brand container starts -->
  <div class="brand-container d-flex align-items-center justify-content-between">

    <!-- App brand starts -->
    <div class="app-brand ms-3">
      <a href="/">
        <img src="~/theme/images/logo.svg" class="logo" alt="CareSync Medical System">
      </a>
    </div>
    <!-- App brand ends -->

    <!-- Pin sidebar starts -->
    <button type="button" class="pin-sidebar me-3">
      <i class="ri-menu-line"></i>
    </button>
    <!-- Pin sidebar ends -->

  </div>
  <!-- Brand container ends -->

  <!-- Sidebar profile starts -->
  <div class="sidebar-profile">
    @if (userRole == "Admin")
    {
      <img src="~/theme/images/admin.png" class="rounded-5" alt="CareSync Admin">
      <h6 class="mb-1 profile-name text-nowrap text-truncate text-primary">@userName</h6>
      <small class="profile-name text-nowrap text-truncate">System Administrator</small>
    }
    else if (userRole == "Doctor")
    {
      <img src="~/theme/images/doctor6.png" class="rounded-5" alt="CareSync Doctor">
      <h6 class="mb-1 profile-name text-nowrap text-truncate text-primary">Dr. @userName</h6>
      <small class="profile-name text-nowrap text-truncate">Medical Doctor</small>
    }
    else if (userRole == "Lab")
    {
      <img src="~/theme/images/lab-tech.png" class="rounded-5" alt="CareSync Lab">
      <h6 class="mb-1 profile-name text-nowrap text-truncate text-primary">@userName</h6>
      <small class="profile-name text-nowrap text-truncate">Lab Technician</small>
    }
    else
    {
      <img src="~/theme/images/patient2.png" class="rounded-5" alt="CareSync Patient">
      <h6 class="mb-1 profile-name text-nowrap text-truncate text-primary">@userName</h6>
      <small class="profile-name text-nowrap text-truncate">Patient</small>
    }
  </div>
  <!-- Sidebar profile ends -->

  <!-- Sidebar menu starts -->
  <div class="sidebarMenuScroll">
    <ul class="sidebar-menu">
      
      @if (userRole == "Admin")
      {
        <!-- Admin Dashboard -->
        <li class="@(currentPath.Contains("/Admin/Dashboard") ? "active current-page" : "")">
          <a href="~/Admin/Dashboard">
            <i class="ri-home-6-line"></i>
            <span class="menu-text">Admin Dashboard</span>
          </a>
        </li>
        
        <!-- Appointments Management -->
        <li class="treeview @(currentPath.Contains("/Admin/Appointments") || currentPath.Contains("/Admin/BookAppointment") ? "active" : "")">
          <a href="#!">
            <i class="ri-calendar-line"></i>
            <span class="menu-text">Appointments</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Equals("/Admin/Appointments", StringComparison.OrdinalIgnoreCase) ? "active current-page" : "")">
              <a href="~/Admin/Appointments">All Appointments</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/BookAppointment") ? "active current-page" : "")">
              <a href="~/Admin/BookAppointment">Book Appointment</a>
            </li>
          </ul>
        </li>
        
        <!-- Doctors Management -->
        <li class="treeview @(currentPath.Contains("/Admin/Doctors") || currentPath.Contains("/Admin/CreateDoctor") ? "active" : "")">
          <a href="#!">
            <i class="ri-stethoscope-line"></i>
            <span class="menu-text">Doctors</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Contains("/Admin/Doctors") && !currentPath.Contains("/CreateDoctor") ? "active current-page" : "")">
              <a href="~/Admin/Doctors">All Doctors</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/CreateDoctor") ? "active current-page" : "")">
              <a href="~/Admin/CreateDoctor">Add Doctor</a>
            </li>
          </ul>
        </li>
        
        <!-- Patients Management -->
        <li class="treeview @(currentPath.Contains("/Admin/Patients") || currentPath.Contains("/Admin/CreatePatient") || currentPath.Contains("/Admin/Patients/Search") ? "active" : "")">
          <a href="#!">
            <i class="ri-user-heart-line"></i>
            <span class="menu-text">Patients</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Equals("/Admin/Patients", StringComparison.OrdinalIgnoreCase) ? "active current-page" : "")">
              <a href="~/Admin/Patients">All Patients</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/CreatePatient") ? "active current-page" : "")">
              <a href="~/Admin/CreatePatient">Add Patient</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/Patients/Search") ? "active current-page" : "")">
              <a href="~/Admin/Patients/Search">Search Patients</a>
            </li>
          </ul>
        </li>
        
        <!-- Lab Management -->
        <li class="treeview @(currentPath.Contains("/Admin/Labs") || currentPath.Contains("/Admin/CreateLabStaff") ? "active" : "")">
          <a href="#!">
            <i class="ri-test-tube-line"></i>
            <span class="menu-text">Lab Management</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Contains("/Admin/Labs/ManageLabs") ? "active current-page" : "")">
              <a href="~/Admin/Labs/ManageLabs">
                <i class="ri-flask-line"></i>
                Manage Labs
              </a>
            </li>
            <li class="@(currentPath.Contains("/Admin/Labs/Create") ? "active current-page" : "")">
              <a href="~/Admin/Labs/Create">
                <i class="ri-add-circle-line"></i>
                Add New Lab
              </a>
            </li>
            <li class="@(currentPath.Contains("/Admin/CreateLabStaff") ? "active current-page" : "")">
              <a href="~/Admin/CreateLabStaff">
                <i class="ri-user-add-line"></i>
                Add Lab Staff
              </a>
            </li>
            <li class="@(currentPath.Contains("/Admin/Labs/Services") ? "active current-page" : "")">
              <a href="~/Admin/Labs/Services">
                <i class="ri-service-line"></i>
                Lab Services
              </a>
            </li>
          </ul>
        </li>
        
        <!-- User Management -->
        <li class="treeview @(currentPath.Contains("/Admin/Users") || currentPath.Contains("/Admin/Roles") ? "active" : "")">
          <a href="#!">
            <i class="ri-group-2-line"></i>
            <span class="menu-text">User Management</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Contains("/Admin/Users") && !currentPath.Contains("/Roles") ? "active current-page" : "")">
              <a href="~/Admin/Users">All Users</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/Roles") && !currentPath.Contains("/RoleRights") ? "active current-page" : "")">
              <a href="~/Admin/Roles">Roles & Permissions</a>
            </li>
            <li class="@(currentPath.Contains("/Admin/RoleRights") ? "active current-page" : "")">
              <a href="~/Admin/RoleRights">Role Rights Mapping</a>
            </li>
          </ul>
        </li>
        
        <!-- Reports & Analytics -->
        <li class="treeview @(currentPath.Contains("/Admin/UserReports") ? "active" : "")">
          <a href="#!">
            <i class="ri-file-chart-line"></i>
            <span class="menu-text">Reports & Analytics</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Contains("/Admin/UserReports") ? "active current-page" : "")">
              <a href="~/Admin/UserReports">User Reports</a>
            </li>
          </ul>
        </li>
      }
      else if (userRole == "Doctor")
      {
        <!-- Doctor Dashboard -->
        <li class="@(currentPath.Contains("/Doctor/Dashboard") ? "active current-page" : "")">
          <a href="~/Doctor/Dashboard">
            <i class="ri-home-smile-2-line"></i>
            <span class="menu-text">Medical Dashboard</span>
          </a>
        </li>
        
        <!-- My Appointments -->
        <li class="@(currentPath.Contains("/Doctor/Appointments") ? "active current-page" : "")">
          <a href="~/Doctor/Appointments">
            <i class="ri-calendar-2-line"></i>
            <span class="menu-text">My Appointments</span>
          </a>
        </li>
        
        <!-- My Patients -->
        <li class="treeview @(currentPath.Contains("/Doctor/Patients") ? "active" : "")">
          <a href="#!">
            <i class="ri-empathize-line"></i>
            <span class="menu-text">My Patients</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Equals("/Doctor/Patients", StringComparison.OrdinalIgnoreCase) ? "active current-page" : "")">
              <a href="~/Doctor/Patients">All Patients</a>
            </li>
            <li class="@(currentPath.Contains("/Doctor/Patients/Search") ? "active current-page" : "")">
              <a href="~/Doctor/Patients/Search">Search Patients</a>
            </li>
          </ul>
        </li>
        
        <!-- Doctor Profile -->
        <li class="@(currentPath.Contains("/Doctor/Profile") ? "active current-page" : "")">
          <a href="~/Doctor/Profile">
            <i class="ri-user-line"></i>
            <span class="menu-text">My Profile</span>
          </a>
        </li>
      }
      else if (userRole == "Patient")
      {
        <!-- Patient Dashboard -->
        <li class="@(currentPath.Contains("/Patient/Dashboard") ? "active current-page" : "")">
          <a href="~/Patient/Dashboard">
            <i class="ri-heart-pulse-line"></i>
            <span class="menu-text">Patient Dashboard</span>
          </a>
        </li>
        
        <!-- My Appointments -->
        <li class="@(currentPath.Contains("/Patient/Appointments") ? "active current-page" : "")">
          <a href="~/Patient/Appointments">
            <i class="ri-calendar-2-line"></i>
            <span class="menu-text">My Appointments</span>
          </a>
        </li>
        
        <!-- Medical Records -->
        <li class="treeview @(currentPath.Contains("/Patient/Medical") || currentPath.Contains("/Patient/Prescriptions") || currentPath.Contains("/Patient/LabResults") || currentPath.Contains("/Patient/Documents") || currentPath.Contains("/Patient/Medications") ? "active" : "")">
          <a href="#!">
            <i class="ri-file-text-line"></i>
            <span class="menu-text">Medical Records</span>
          </a>
          <ul class="treeview-menu">
            <li class="@(currentPath.Contains("/Patient/MedicalHistory") ? "active current-page" : "")">
              <a href="~/Patient/MedicalHistory">Medical History</a>
            </li>
            <li class="@(currentPath.Contains("/Patient/Medications") ? "active current-page" : "")">
              <a href="~/Patient/Medications">My Medications</a>
            </li>
            <li class="@(currentPath.Contains("/Patient/Prescriptions") ? "active current-page" : "")">
              <a href="~/Patient/Prescriptions">Prescriptions History</a>
            </li>
            <li class="@(currentPath.Contains("/Patient/LabResults") ? "active current-page" : "")">
              <a href="~/Patient/LabResults">Lab Reports</a>
            </li>
            <li class="@(currentPath.Contains("/Patient/Documents") ? "active current-page" : "")">
              <a href="~/Patient/Documents">Medical Documents</a>
            </li>
          </ul>
        </li>
        
        <!-- My Profile -->
        <li class="@(currentPath.Contains("/Patient/Profile") ? "active current-page" : "")">
          <a href="~/Patient/Profile">
            <i class="ri-user-line"></i>
            <span class="menu-text">My Profile</span>
          </a>
        </li>
      }
      else if (userRole == "Lab")
      {
        <!-- Lab Dashboard -->
        <li class="@(currentPath.Contains("/Lab/Dashboard") ? "active current-page" : "")">
          <a href="~/Lab/Dashboard">
            <i class="ri-test-tube-line"></i>
            <span class="menu-text">Lab Dashboard</span>
          </a>
        </li>
        
        <!-- Test Requests -->
        <li class="@(currentPath.Contains("/Lab/TestRequests") ? "active current-page" : "")">
          <a href="~/Lab/TestRequests">
            <i class="ri-file-list-3-line"></i>
            <span class="menu-text">Test Requests</span>
          </a>
        </li>
        
        <!-- Lab Services -->
        <li class="@(currentPath.Contains("/Lab/Services") ? "active current-page" : "")">
          <a href="~/Lab/Services">
            <i class="ri-service-line"></i>
            <span class="menu-text">Lab Services</span>
          </a>
        </li>
        
        <!-- Lab Reports -->
        <li class="@(currentPath.Contains("/Lab/ReportsManagement") ? "active current-page" : "")">
          <a href="~/Lab/ReportsManagement">
            <i class="ri-file-chart-line"></i>
            <span class="menu-text">Lab Reports</span>
          </a>
        </li>
        
        <!-- Lab Profile -->
        <li class="@(currentPath.Contains("/Lab/Profile") || currentPath.Contains("/Lab/TechnicianProfile") ? "active current-page" : "")">
          <a href="~/Lab/Profile">
            <i class="ri-user-line"></i>
            <span class="menu-text">Lab Profile</span>
          </a>
        </li>
      }
      
      <!-- Logout (Common for all roles) -->
      <li class="mt-4">
        <a href="~/Auth/Logout" class="text-danger">
          <i class="ri-logout-box-line"></i>
          <span class="menu-text">Logout</span>
        </a>
      </li>
    </ul>
  </div>
  <!-- Sidebar menu ends -->

  @* <!-- Sidebar contact starts -->
  <div class="sidebar-contact">
    <p class="fw-light mb-1 text-nowrap text-truncate">Emergency Contact</p>
    <h5 class="m-0 lh-1 text-nowrap text-truncate">0987654321</h5>
    <i class="ri-phone-line"></i>
  </div>
  <!-- Sidebar contact ends --> *@

</nav>
<!-- Sidebar wrapper ends -->
