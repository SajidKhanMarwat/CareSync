===========================================
COMPLETE DASHBOARD INTEGRATION EXAMPLE
===========================================

This file shows EXACTLY how to integrate the Dashboard page with the backend APIs.
Copy this code into Dashboard.cshtml.cs

===========================================
Step 1: Update Dashboard.cshtml.cs
===========================================

using CareSync.Services;
using Microsoft.AspNetCore.Mvc;
using CareSync.Pages.Shared;

namespace CareSync.Pages.Admin;

public class DashboardModel : BasePageModel
{
    private readonly AdminApiService _adminApi;
    private readonly ILogger<DashboardModel> _logger;

    public DashboardModel(AdminApiService adminApi, ILogger<DashboardModel> logger)
    {
        _adminApi = adminApi;
        _logger = logger;
    }

    // Properties for view binding
    public int TotalAppointments { get; set; }
    public decimal AppointmentsPercentage { get; set; }
    public int TotalDoctors { get; set; }
    public decimal DoctorsPercentage { get; set; }
    public int TotalPatients { get; set; }
    public decimal PatientsPercentage { get; set; }
    
    public string PercentageClass(decimal percentage) => percentage >= 0 ? "text-success" : "text-danger";
    public string PercentageIcon(decimal percentage) => percentage >= 0 ? "ri-arrow-up-line" : "ri-arrow-down-line";

    public async Task<IActionResult> OnGetAsync()
    {
        // Check authentication
        var authResult = RequireRole("Admin");
        if (authResult != null) return authResult;

        try
        {
            // Call API
            var result = await _adminApi.GetDashboardStatsAsync<ApiResult<DashboardStatsData>>();
            
            if (result != null && result.IsSuccess && result.Data != null)
            {
                // Bind data to properties
                TotalAppointments = result.Data.TotalAppointments;
                AppointmentsPercentage = result.Data.ThisVsLastMonthPercentageAppointment;
                
                TotalDoctors = result.Data.TotalDoctors;
                DoctorsPercentage = result.Data.ThisVsLastMonthPercentageDoctors;
                
                TotalPatients = result.Data.TotalPatients;
                PatientsPercentage = result.Data.ThisVsLastMonthPercentagePatients;
            }
            else
            {
                _logger.LogWarning("Failed to load dashboard data from API");
                // Set default values
                TotalAppointments = 0;
                TotalDoctors = 0;
                TotalPatients = 0;
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Error loading dashboard");
            // Set default values on error
            TotalAppointments = 0;
            TotalDoctors = 0;
            TotalPatients = 0;
        }

        return Page();
    }
}

// DTO classes (add these at the bottom of the file)
public class ApiResult<T>
{
    public bool IsSuccess { get; set; }
    public T? Data { get; set; }
    public int StatusCode { get; set; }
    public object? Error { get; set; }
}

public class DashboardStatsData
{
    public int TotalAppointments { get; set; }
    public decimal ThisVsLastMonthPercentageAppointment { get; set; }
    public int TotalDoctors { get; set; }
    public decimal ThisVsLastMonthPercentageDoctors { get; set; }
    public int TotalPatients { get; set; }
    public decimal ThisVsLastMonthPercentagePatients { get; set; }
}

===========================================
Step 2: Update Dashboard.cshtml
===========================================

Replace the hardcoded numbers with Model properties:

<!-- Statistics Cards -->
<div class="row g-4 mb-4">
    <!-- Appointments Card -->
    <div class="col-sm-4 col-12">
        <div class="card mb-3 shadow-sm border-0 h-100">
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <div class="p-2 border border-primary rounded-circle me-3">
                        <div class="icon-box md bg-primary-lighten rounded-5">
                            <i class="ri-calendar-check-line fs-4 text-primary"></i>
                        </div>
                    </div>
                    <div class="d-flex flex-column">
                        <h1 class="lh-1">@Model.TotalAppointments</h1>
                        <p class="m-0">Appointments</p>
                    </div>
                </div>
                <div class="d-flex align-items-end justify-content-between mt-3">
                    <a class="text-primary" href="~/Admin/Appointments">
                        <span>View All</span>
                        <i class="ri-arrow-right-line text-primary ms-1"></i>
                    </a>
                    <div class="text-end">
                        <p class="mb-0 @Model.PercentageClass(Model.AppointmentsPercentage)">
                            <i class="@Model.PercentageIcon(Model.AppointmentsPercentage)"></i>
                            @Math.Abs(Model.AppointmentsPercentage).ToString("F1")%
                        </p>
                        <span class="badge bg-primary-light text-primary small">this month</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Doctors Card -->
    <div class="col-sm-4 col-12">
        <div class="card mb-3 shadow-sm border-0 h-100">
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <div class="p-2 border border-primary rounded-circle me-3">
                        <div class="icon-box md bg-primary-lighten rounded-5">
                            <i class="ri-stethoscope-line fs-4 text-primary"></i>
                        </div>
                    </div>
                    <div class="d-flex flex-column">
                        <h1 class="lh-1">@Model.TotalDoctors</h1>
                        <p class="m-0">Doctors</p>
                    </div>
                </div>
                <div class="d-flex align-items-end justify-content-between mt-3">
                    <a class="text-primary" href="~/Admin/Doctors">
                        <span>View All</span>
                        <i class="ri-arrow-right-line ms-1"></i>
                    </a>
                    <div class="text-end">
                        <p class="mb-0 @Model.PercentageClass(Model.DoctorsPercentage)">
                            <i class="@Model.PercentageIcon(Model.DoctorsPercentage)"></i>
                            @Math.Abs(Model.DoctorsPercentage).ToString("F1")%
                        </p>
                        <span class="badge bg-primary-light text-primary small">this month</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Patients Card -->
    <div class="col-sm-4 col-12">
        <div class="card mb-3 shadow-sm border-0 h-100">
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <div class="p-2 border border-primary rounded-circle me-3">
                        <div class="icon-box md bg-primary-lighten rounded-5">
                            <i class="ri-user-heart-line fs-4 text-primary"></i>
                        </div>
                    </div>
                    <div class="d-flex flex-column">
                        <h1 class="lh-1">@Model.TotalPatients</h1>
                        <p class="m-0">Patients</p>
                    </div>
                </div>
                <div class="d-flex align-items-end justify-content-between mt-3">
                    <a class="text-primary" href="~/Admin/Patients">
                        <span>View All</span>
                        <i class="ri-arrow-right-line text-primary ms-1"></i>
                    </a>
                    <div class="text-end">
                        <p class="mb-0 @Model.PercentageClass(Model.PatientsPercentage)">
                            <i class="@Model.PercentageIcon(Model.PatientsPercentage)"></i>
                            @Math.Abs(Model.PatientsPercentage).ToString("F1")%
                        </p>
                        <span class="badge bg-primary-light text-primary small">this month</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

===========================================
Step 3: Test the Integration
===========================================

1. Make sure the API is running:
   - Project: CareSync.API
   - URL: http://localhost:5157
   - Test endpoint: http://localhost:5157/api/admin/dashboard/stats

2. Run the UI project:
   - Project: CareSync
   - URL: http://localhost:XXXX (check launchSettings.json)

3. Navigate to: /Admin/Dashboard

4. You should see:
   - Real data from database
   - Actual appointment/doctor/patient counts
   - Month-over-month percentage changes
   - Green arrows for increases, red for decreases

===========================================
Step 4: Add Error Handling (Optional)
===========================================

Add this to Dashboard.cshtml for better UX:

@if (Model.TotalAppointments == 0 && Model.TotalDoctors == 0 && Model.TotalPatients == 0)
{
    <div class="alert alert-info">
        <i class="ri-information-line me-2"></i>
        <strong>No data available</strong> - Make sure the API is running and database is seeded.
    </div>
}

===========================================
Step 5: Same Pattern for Other Pages
===========================================

Use the EXACT SAME pattern for:
- Doctors.cshtml.cs
- Patients.cshtml.cs
- Appointments.cshtml.cs
- etc.

Just change:
1. The API method call (e.g., GetAllDoctorsAsync)
2. The DTO class name (e.g., DoctorListData)
3. The properties you're binding

Example for Doctors page:

public async Task<IActionResult> OnGetAsync()
{
    var result = await _adminApi.GetAllDoctorsAsync<ApiResult<List<DoctorListData>>>();
    
    if (result?.IsSuccess == true)
        Doctors = result.Data ?? new List<DoctorListData>();
    
    return Page();
}

===========================================
DONE! ðŸŽ‰
===========================================

Your admin dashboard is now connected to the real backend!

Next: Apply this same pattern to all other admin pages.
